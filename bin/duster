#!/usr/bin/env bash

# ./bin/duster:                    lint with all
# ./bin/duster fix:                fix with all
# ./bin/duster ecs:                lint with ecs
# ./bin/duster ecs fix:            fix with ecs
# ./bin/duster tlint:              lint with tlint
# ./bin/duster tlint fix:          fix with tlint
# ./bin/duster init:               initialize
# ./bin/duster phpcs:              lint with ecs (alias for previous phpcs)
# ./bin/duster phpcs fix:          fix with ecs (alias for previous phpcs)

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"
SYM_DIR="$( dirname "$( readlink ${BASH_SOURCE[0]} )" )"
BIN_DIR="${DIR}/${SYM_DIR}"

if [[ $# == 0 ]]; then
  filename="lint"
elif [[ $1 == "phpcs" && $2 == 'fix' ]]; then
    filename="fix-ecs"
elif [[ $1 == "phpcs" && $2 == 'lint' ]]; then
    filename="lint-ecs"
elif [[ $# == 1 ]]; then
  if [[ $1 == "fix" ]]; then
    filename="fix"
  elif [[ $1 == 'init' ]]; then
    filename="init"
  elif [[ $1 == 'help' ]]; then
    filename="help"
  elif [[ $1 == 'lint' ]]; then
    filename="lint"
  else
    filename="lint-$1"
  fi
else
  filename="fix-$1"
fi

filename="$BIN_DIR/actions/$filename"

printf $filename

if [ ! -f "$filename" ]; then
  printf "\nSorry, that is an invalid selection.\n[$filename does not exist]\n"

  exit
fi

. $filename
